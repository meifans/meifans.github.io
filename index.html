<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="技术 博客">
<meta property="og:type" content="website">
<meta property="og:title" content="Meifans">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Meifans">
<meta property="og:description" content="技术 博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Meifans">
<meta name="twitter:description" content="技术 博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn"}},
    duoshuo: {
      userId: '0',
      author: 'meifans'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Meifans</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Meifans</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Startseite
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archiv
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/service-discovery/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/service-discovery/" itemprop="url">浅谈服务发现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:56:38+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="服务发现"><a href="#服务发现" class="headerlink" title="服务发现"></a>服务发现</h1><h2 id="什么是服务发现？"><a href="#什么是服务发现？" class="headerlink" title="什么是服务发现？"></a>什么是服务发现？</h2><ul>
<li>服务发现（组件）记录了分布式系统中所有服务的信息，其他服务可以据此找到这些服务。DNS就是一个服务发现的例子，但是复杂系统的服务发现（组件）提供更多的功能，服务元数据存储、健康监控、多种查询和实时更新等。</li>
<li>不同的使用情境，服务发现的含义也不同。例如，网络设备发现、零配置网络（ rendezvous ）发现和 SOA 发现等。无论是哪一种使用情境，服务发现提供了一种协调机制，方便服务的发布和查找。</li>
</ul>
<h2 id="服务发现的关键特性"><a href="#服务发现的关键特性" class="headerlink" title="服务发现的关键特性"></a>服务发现的关键特性</h2><ol>
<li>服务发现是支撑大规模 SOA 的核心服务，它必须是高可用的，提供注册、目录和查找三大关键特性，仅仅提供服务目录是不够的。 服务元数据存储是服务发现的关键，因为复杂的服务提供了多种服务接口和端口，部署环境也比较复杂。一旦服务发现组件存储了大量元数据，它就必须提供强大的查询功能，包括服务健康和其它状态的查询。</li>
</ol>
<h2 id="服务发现的优势"><a href="#服务发现的优势" class="headerlink" title="服务发现的优势"></a>服务发现的优势</h2><ol>
<li>零配置 ：不用使用硬编码的网络地址，只需服务的名字（有时甚至连名字都不用）就能使用服务。在现代的体系架构中，单个服务实例的启动和销毁很常见，所以应该做到：无需了解整个架构的部署拓扑，就能找到这个实例。</li>
</ol>
<h2 id="服务发现解决方案"><a href="#服务发现解决方案" class="headerlink" title="服务发现解决方案"></a>服务发现解决方案</h2><ul>
<li><p>DNS ：小规模系统可以先使用 DNS 作为服务发现手段。一旦服务节点的启动和销毁变得更加动态， DNS 就有问题了，因为 DNS 记录传播的速度可能跟不上服务节点变化的速度。</p>
</li>
<li><p>ZooKeeper ：大概是最成熟的配置存储方案，它的历史比较长，提供了包括配置管理、领导人选举和分布式锁在内的完整解决方案。因此， ZooKeeper 是非常有竞争力的通用的服务发现解决方案，当然，它也显得过于复杂。</p>
<blockquote>
<p>etcd 和 doozerd 是新近出现的服务发现解决方案，它们与 ZooKeeper 具有相似的架构和功能，因此可与 ZooKeeper 互换使用。</p>
</blockquote>
</li>
<li><p>Consul : Consul 是一种更新的服务发现解决方案。除了服务发现，它还提供了配置管理和一种键值存储。 Consul 提供了服务节点的健康检查功能，支持使用 DNS SRV 查找服务，这大大增强了它与其它系统的互操作性。</p>
<blockquote>
<p>Consul 与 ZooKeeper 的主要区别是： Consul 提供了 DNS 和 HTTP 两种 API ，而 ZooKeeper 只支持专门客户端的访问。</p>
</blockquote>
</li>
<li><p>Eureka :  AP( Availability and Partition ) 系统，在netflix经过了检验。当出现网络分区时，选择可用性，而不是一致性。</p>
</li>
</ul>
<h2 id="实施服务发现最大的挑战？"><a href="#实施服务发现最大的挑战？" class="headerlink" title="实施服务发现最大的挑战？"></a>实施服务发现最大的挑战？</h2><p>服务发现很复杂，这种复杂性源自分布式系统的复杂性。</p>
<p>一开始，你可以用一个配置文件实现服务发现，这个文件中包含了所有服务的名字、 IP 地址和端口等信息。当系统变得更加动态后，你就要把服务发现从静态配置迁移到一个真正的解决方案。这个迁移过程，并不像一般人所想的那么容易。最大的一项挑战是无从知晓所选的服务发现系统的侵入性如何：一旦选定一个服务发现系统，就很难再改用其它的服务发现系统，因此，一开始就必须选择正确的解决方案。</p>
<p>很多服务发现系统都实现了某种形式的分布式共识算法，保证即使有节点失效系统仍然能够正常运转。但是，这些算法是出名地难实现，关键是要识别出分布式系统中失效的节点，这很困难。如果不能正确地识别，就不会正确地实现分布式共识算法。</p>
<h2 id="已有的系统如何集成服务发现功能"><a href="#已有的系统如何集成服务发现功能" class="headerlink" title="已有的系统如何集成服务发现功能"></a>已有的系统如何集成服务发现功能</h2><p>第一步，让服务的客户无需了解服务的具体部署细节，通过查询外部的服务信息存储来找到服务。一开始简单地使用属性保存服务的元数据就可以了，随着系统变得更加动态，再升级到使用外部的服务发现系统。</p>
<p>一旦选定了服务发现的机制（网络或者服务），理解了系统的优化点（这是最难的部分），接下来只要集成注册和查找组件就可以了。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/datebase/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/datebase/" itemprop="url">浅谈索引</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:56:24+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h2><h3 id="为什么需要索引-why"><a href="#为什么需要索引-why" class="headerlink" title="为什么需要索引 (why)"></a>为什么需要索引 (why)</h3><p>数据在磁盘上是以块（也称页）的形式存储的，访问数据的时候会一并访问整个数据块。磁盘上的这些数据块与链表类似，即它们都包含一个数据段和一个指针，指针指向下一个节点（数据块）的内存地址，而且它们都不需要连续存储（即逻辑上相邻的数据块在物理上可以相隔很远）。<br>鉴于很多记录只能做到按一个字段排序，所以要查询某个未经排序的字段，就需要使用线性查找，即要访问N/2个数据块，其中N指的是一个表所涵盖的所有数据块。如果该字段是非键字段（也就是说，不包含唯一值），那么就要搜索整个表空间，即要访问全部N个数据块。<br>然而，对于经过排序的字段，可以使用二分查找，因此只要访问log2 N个数据块。同样，对于已经排过序的非键字段，只要找到更大的值，也就不用再搜索表中的其他数据块了。这样一来，性能就会有实质性的提升。</p>
<h3 id="什么是索引-what"><a href="#什么是索引-what" class="headerlink" title="什么是索引 (what)"></a>什么是索引 (what)</h3><p>索引是对记录按照多个字段进行排序的一种方式。对表中的某个字段建立索引会创建另一种数据结构，其中保存着字段的值，每个值又指向与它相关的记录。这种索引的数据结构是经过排序的，所以可以使用二分查找，b+树搜索。<br>索引的缺点是占用额外的磁盘空间。因为索引保存在MyISAM数据库中，所以如果为同一个表中的很多字段都建立索引，那这个文件可能会很快膨胀到文件系统规定的上限。</p>
<blockquote>
<p>MyISAM为mysql默认的数据库引擎，自从8.0开始，mysql默认的引擎已经改为InnoDB.</p>
</blockquote>
<h4 id="聚集索引"><a href="#聚集索引" class="headerlink" title="聚集索引"></a>聚集索引</h4><p>  InnoDB中表数据按照主键顺序存放，聚集索引就是按照每张表的主键构造一颗b+树，叶节点中存有整张表的行记录数据，因此聚集索引的页节点也是数据页。每个数据页都通过一个双向的链表进行链接。<br>  实际的数据页只能按照一棵b+树排序，因此每个表只能有一个聚集索引。</p>
<blockquote>
<p>聚集索引并不是按照顺序物理的存储数据，那样维护的成本非常高。<br>它是逻辑上连续的。通过页的双向链表链接，页按照主键排序。注意页内的记录也是通过双向链表维护，物理存储上可以同样不按照主键存储。</p>
<h4 id="非聚集索引"><a href="#非聚集索引" class="headerlink" title="非聚集索引"></a>非聚集索引</h4><p>   即叶级别不包含行的全部数据。<br>  叶节点：</p>
<ul>
<li>键值  索引字段的值</li>
<li>书签  用来告诉InnoDB，哪里可以找到与索引对应的行数据</li>
</ul>
</blockquote>
<h3 id="索引的原理-（how）"><a href="#索引的原理-（how）" class="headerlink" title="索引的原理 （how）"></a>索引的原理 （how）</h3><p>InnoDB索引是使用b+树来组织的，以每个页（16K）为基本单元,每个页包含有前后页的指针。b+树高扇出，只需要2-3次io即可从数百万的数据中找到指定行所在的页。然后再页内使用二分查找，来锁定具体行。</p>
<h4 id="聚集索引-1"><a href="#聚集索引-1" class="headerlink" title="聚集索引"></a>聚集索引</h4><p>  <strong>优点</strong></p>
<ul>
<li>主键的排序查找和范围查找非常快</li>
<li><p>可以在索引的页节点上直接找到数据</p>
<h4 id="非聚集索引-1"><a href="#非聚集索引-1" class="headerlink" title="非聚集索引"></a>非聚集索引</h4><p>通过它来查找数据时，会查找它的b+树，然后通过叶级别的指针获得指向主键索引的主键，然后在通过主键索引（聚集索引）来找到一个完整的行记录。他们的关系如下图所示</p>
<p><img src="pictures/relationship.png" alt="relationship"></p>
</li>
</ul>
<h3 id="索引使用原则-when"><a href="#索引使用原则-when" class="headerlink" title="索引使用原则 (when)"></a>索引使用原则 (when)</h3><h4 id="数据库层原则"><a href="#数据库层原则" class="headerlink" title="数据库层原则"></a>数据库层原则</h4><ul>
<li><p>高选择性</p>
<blockquote>
<p>某个字段取值很广，几乎没有重复</p>
</blockquote>
</li>
<li><p>取出表中少部分数据</p>
<blockquote>
<p>即使某个字段为高选择性，也可能取出很多数据<br>i.e：某个字段表示日期，查询大于某个很小的日期，就可以取出表中大部分数据。</p>
</blockquote>
</li>
</ul>
<h4 id="命令层原则"><a href="#命令层原则" class="headerlink" title="命令层原则"></a>命令层原则</h4><ul>
<li>为经常被用作查询条件，或要求排序的字段建立索引<ul>
<li>order by ,group by,distinct 后面的字段</li>
</ul>
</li>
<li>经常用作表连接和查询选择字段建立索引<ul>
<li>where , join</li>
</ul>
</li>
<li>对于一个存在大量更新的表，索引数目一般不超过3个。<blockquote>
<p>索引提高了数据访问速度，但也增加了插入，删除，更新的时间。</p>
</blockquote>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/JNDI/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/JNDI/" itemprop="url">浅谈 java 中 JNDI</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:55:42+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="命名（naming）"><a href="#命名（naming）" class="headerlink" title="命名（naming）"></a>命名（naming）</h3><p>计算机系统的一个基础设置就是命名服务–名字与一个对象联系，可以通过这个名字得到对象。比如，当你发邮件时，需要提供一个收件人地址，当访问一个文件时，需要提供它的名字。<br>一个命名服务允许你通过一个名字找一个对象。</p>
<blockquote>
<p>计算机中的例子：<br>Internet Domain Name System (DNS) 匹配域名和ip：<br>www.example.com ==&gt; 192.0.2.5<br>文件系统匹配一个文件和一个程序里文件的引用，用来直接访问文件<br>c:\bin\autoexec.bat ==&gt; File Reference<br>这两个例子从广义的范围上说明了命名服务</p>
</blockquote>
<h4 id="名字组成"><a href="#名字组成" class="headerlink" title="名字组成"></a>名字组成</h4><p>为了在一个命名系统中寻找对象，它规定的命名规范（systems naming convention）必须要遵守。<br>| 命名系统 | 分隔符 | 名字 |<br>| — | — | — |<br>| UNIX file system | “/“ | /usr/hello |<br>| DNS | “.” | sales.wiz.com |<br>| LDAP | “,”and”=” | cn=Rosanna Lee , o=Sun,c=US |</p>
<h3 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h3><p>一个目录系统既联系了名字与对象，也连接了对象和属性。<br>不仅可以通过名字找到对象，还可以获得对象的属性或者基于属性搜寻对象。</p>
<h2 id="JNDI概览"><a href="#JNDI概览" class="headerlink" title="JNDI概览"></a>JNDI概览</h2><p> Java Naming and Directory Interface™ (JNDI) 是一个提供命名和目录服务的程序接口</p>
<h3 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h3><p>JNDI架构包含一组api和一组服务提供接口 service provider interface (SPI)。Java应用使用JNDIapi访问多个命名和目录服务。<br>SPI实现了可插拔式的命名、目录服务，允许Java通过JNDIapi访问这些服务。</p>
<p><img src="pictures/jndi-architecture.png" alt="JNDI架构"></p>
<h3 id="包"><a href="#包" class="headerlink" title="包"></a>包</h3><p>JDK包含下面这些服务提供者：</p>
<ul>
<li>LDAP</li>
<li>Common Object Request Broker Architecture (CORBA) Common Object Services (COS) name service</li>
<li>Java Remote Method Invocation (RMI) Registry</li>
<li>Domain Name Service (DNS)</li>
</ul>
<p>JNDI分成5个包</p>
<ul>
<li>javax.naming</li>
<li>javax.naming.directory</li>
<li>javax.naming.ldap</li>
<li>javax.naming.event</li>
<li>javax.naming.spi</li>
</ul>
<h4 id="Naming包"><a href="#Naming包" class="headerlink" title="Naming包"></a>Naming包</h4><ol>
<li>Context   核心接口，提供寻找对象，绑定，重命名，创建和销毁功能。<ul>
<li>lookup   提供名字返回对象</li>
<li>bindings 绑定名字和对象</li>
<li>name     重命名</li>
</ul>
</li>
<li>InitialContext 为服务提供启动点</li>
</ol>
<h4 id="Directory-和LDAP包"><a href="#Directory-和LDAP包" class="headerlink" title="Directory 和LDAP包"></a>Directory 和LDAP包</h4><p><strong>Directory</strong></p>
<p>javax.naming.directory  继承了javax.naming，提供了命名和目录服务。这个包允许应用使用指定的属性检索保存在目录中的对象。<br>DirContext 代表一个目录context，定义了检查和更细属性的方法，通过操作一个目录实体。</p>
<ul>
<li>Attributes 可以检索一个directory entity的属性，可以增删改查。</li>
</ul>
<p><strong>LDAP</strong></p>
<p>javax.naming.ldap 为LDAP v3特性的应用提供了支持。事实上，绝大多数应用使用LDAP去找javax.naming.directory包就足够了，完全不需要ldap包.</p>
<h4 id="Event和Service-Provider-包"><a href="#Event和Service-Provider-包" class="headerlink" title="Event和Service Provider 包"></a>Event和Service Provider 包</h4><p><strong>event</strong></p>
<p>javax.naming.event 包支持命名和目录服务中的事件通知</p>
<ul>
<li>Events 一个NamingEvent 代表一个命名或目录服务产生的事件，</li>
<li>Listeners NamingListener 倾听者 有不同的实现</li>
</ul>
<p><strong>ServiceProvider</strong></p>
<p>javax.naming.spi 包用来为不同的服务提供者提供挂钩，以便使用JNDI可以访问相应的服务。</p>
<ol>
<li>Plug-In Architecture</li>
<li>Java Object Support</li>
<li>Multiple Naming Systems</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/spring/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/spring/" itemprop="url">spring 技术指南</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:55:08+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Spring-面试指南¡"><a href="#Spring-面试指南¡" class="headerlink" title="Spring 面试指南¡"></a>Spring 面试指南¡</h1><h2 id="Spring-核心"><a href="#Spring-核心" class="headerlink" title="Spring 核心"></a>Spring 核心</h2><h3 id="Spring-Ioc容器"><a href="#Spring-Ioc容器" class="headerlink" title="Spring Ioc容器"></a>Spring Ioc容器</h3><ol>
<li><p>什么是Ioc</p>
<p>依赖注入（Dependency Injection），即把某个对象依赖的所有对象注入进去，相比于在对象内直接显式的new出来，把创建依赖对象的权利反转，交给了容器，所以也叫控制反转（Inverse of Control）。</p>
</li>
</ol>
<p><code>优势</code>： 可以根据配置或环境自由决定注入对象的具体类型,增加灵活性。避免了硬编码方便mock，测试方便。</p>
<ol>
<li><p>bean 生命周期</p>
<ol>
<li><p>寻找bean的BeanDefinition（xml方式或注解Java对象方式），并实例化bean</p>
<blockquote>
<p>提供元数据的三种方式</p>
<ol>
<li>Xml配置文件</li>
<li>基于注解的配置</li>
<li>基于Java的配置</li>
</ol>
</blockquote>
</li>
<li><p>对bean进行依赖注入。</p>
</li>
<li><p>注入实现各种Aware。</p>
<ul>
<li>BeanNameAware        注入bean的名字</li>
<li>BeanClassLoaderAware 注入bean的classloader</li>
<li>BeanFactoryAware     注入bean所在的factory</li>
</ul>
</li>
<li><p>BeanPostProcessor 的before方法 -&gt; InitializingBean.afterPropertiesSet()（bean的初始化方法） -&gt; BeanPostProcessor 的after方法</p>
</li>
<li><p>DisposableBean.destory 释放资源  -&gt; destory (指定的bean销毁方法)</p>
</li>
</ol>
</li>
<li><p>bean 类型</p>
<ul>
<li><code>singleton</code> 单例（默认）</li>
<li><code>prototype</code> 原型 每个bean都是新的</li>
<li><code>request</code> 每次http请求都会创建一个bean，该作用域仅在基于web的Spring ApplicationContext情形下有效。</li>
<li><code>session</code> 在一个HTTP Session中，一个bean定义对应一个实例。该作用域仅在基于web的Spring   + ApplicationContext情形下有效。</li>
<li><code>global-session</code> 在一个全局的HTTP Session中，一个bean定义对应一个实例。该作用域仅在基于web的Spring ApplicationContext情形下有效。</li>
</ul>
</li>
<li><p>ApplicationContext 相比 BeanFactory的优势</p>
<ul>
<li>支持多于一种配置（不止xml文件）</li>
<li>支持bean注册观察者，publish event</li>
<li>I18n …and so on</li>
</ul>
</li>
<li><p>自动装配</p>
<ul>
<li><p><code>no</code>:<br>这是Spring框架的默认设置，在该设置下自动装配是关闭的，开发者需要自行在bean定义中用标签明确的设置依赖关系。</p>
</li>
<li><p><code>byName</code>:<br>该选项可以根据bean名称设置依赖关系。当向一个bean中自动装配一个属性时，容器将根据bean的名称自动在在配置文件中查询一个匹配的bean。如果找到的话，就装配这个属性，如果没找到的话就报错。</p>
</li>
<li><p><code>byType</code>:<br>该选项可以根据bean类型设置依赖关系。当向一个bean中自动装配一个属性时，容器将根据bean的类型自动在在配置文件中查询一个匹配的bean。如果找到的话，就装配这个属性，如果没找到的话就报错。</p>
</li>
<li><p><code>constructor</code>:<br>造器的自动装配和byType模式类似，但是仅仅适用于与有构造器相同参数的bean，如果在容器中没有找到与构造器参数类型一致的bean，那么将会抛出异常。</p>
</li>
<li><p><code>autodetect</code>:<br>该模式自动探测使用构造器自动装配或者byType自动装配。首先，首先会尝试找合适的带参数的构造器，如果找到的话就是用构造器自动装配，如果在bean内部没有找到相应的构造器或者是无参构造器，容器就会自动选择byTpe的自动装配方式。</p>
</li>
</ul>
</li>
<li><p>常见的ApplicationContext 的实现方式</p>
<ol>
<li><p>ClassPathXmlApplicationContext：从classpath的XML配置文件中读取上下文，并生成上下文定义。应用程序上下文从程序环境变量中取得。</p>
<p>   ApplicationContext context = new ClassPathXmlApplicationContext(“bean.xml”);</p>
</li>
<li><p>FileSystemXmlApplicationContext ：由文件系统中的XML配置文件读取上下文。</p>
<p>   ApplicationContext context = new FileSystemXmlApplicationContext(“bean.xml”);</p>
</li>
<li><p>XmlWebApplicationContext：由Web应用的XML文件读取上下文。</p>
</li>
</ol>
</li>
<li><p>ApplicationContext中的事件类型</p>
<p>一个bean实现了ApplicationListener接口，当一个ApplicationEvent 被发布以后，bean会自动被通知。</p>
<ul>
<li><p>上下文更新事件（ContextRefreshedEvent）：该事件会在ApplicationContext被初始化或者更新时发布。也可以在调用ConfigurableApplicationContext 接口中的refresh()方法时被触发。</p>
</li>
<li><p>上下文开始事件（ContextStartedEvent）：当容器调用ConfigurableApplicationContext的Start()方法开始/重新开始容器时触发该事件。</p>
</li>
<li><p>上下文停止事件（ContextStoppedEvent）：当容器调用ConfigurableApplicationContext的Stop()方法停止容器时触发该事件。</p>
</li>
<li><p>上下文关闭事件（ContextClosedEvent）：当ApplicationContext被关闭时触发该事件。容器被关闭时，其管理的所有单例Bean都被销毁。</p>
</li>
<li><p>请求处理事件（RequestHandledEvent）：在Web应用中，当一个http请求（request）结束触发该事件。</p>
</li>
<li><p>自定义事件 ： customEvent 继承 ApplicationEvent,customListener实现ApplicationListener接口。</p>
</li>
</ul>
</li>
<li><p>spring 常用模块</p>
<ul>
<li><p>The Core container module</p>
<blockquote>
<p>提供 Spring 框架的基本功能。核心容器的主要组件是BeanFactory，它是工厂模式的实现。BeanFactory 使用控制反转 （IOC） 模式将应用程序的配置和依赖性规范与实际的应用程序代码分开。</p>
</blockquote>
</li>
<li><p>Application context module</p>
<blockquote>
<p>Spring 上下文是一个配置文件，向 Spring 框架提供上下文信息。Spring 上下文包括企业服务，例如 JNDI、EJB、电子邮件、国际化、校验和调度功能。</p>
</blockquote>
</li>
<li><p>AOP module (Aspect Oriented Programming)</p>
</li>
<li><p>JDBC abstraction and DAO module</p>
<blockquote>
<p>JDBC DAO 抽象层提供了有意义的异常层次结构，可用该结构来管理异常处理和不同数据库供应商抛出的错误消息。异常层次结构简化了错误处理，并且极大地降低了需要编写的异常代码数量（例如打开和关闭连接）。Spring DAO 的面向 JDBC 的异常遵从通用的 DAO 异常层次结构。</p>
</blockquote>
</li>
<li><p>O/R mapping integration module (Object/Relational)</p>
<blockquote>
<p>Spring 框架插入了若干个 ORM 框架，从而提供了 ORM 的对象关系工具，其中包括 JDO、Hibernate 和 iBatis SQL Map。所有这些都遵从 Spring 的通用事务和 DAO 异常层次结构。</p>
</blockquote>
</li>
<li><p>Web module</p>
<blockquote>
<p>Web 上下文模块建立在应用程序上下文模块之上，为基于 Web 的应用程序提供了上下文。Web 模块还简化了处理多部分请求以及将请求参数绑定到域对象的工作。</p>
</blockquote>
</li>
<li><p>MVC framework module</p>
<blockquote>
<p>MVC 框架是一个全功能的构建 Web 应用程序的 MVC 实现。通过策略接口，MVC 框架变成为高度可配置的，MVC 容纳了大量视图技术，其中包括 JSP、Velocity、Tiles、iText 和 POI。</p>
</blockquote>
</li>
</ul>
</li>
</ol>
<h3 id="Spring-事务管理"><a href="#Spring-事务管理" class="headerlink" title="Spring 事务管理"></a>Spring 事务管理</h3><ul>
<li>类型 ：声明式事务管理、编程式事务管理。</li>
<li>Advice类型：</li>
</ul>
<h2 id="Spring-新特性"><a href="#Spring-新特性" class="headerlink" title="Spring 新特性"></a>Spring 新特性</h2><h2 id="Spring-对orm支持"><a href="#Spring-对orm支持" class="headerlink" title="Spring 对orm支持"></a>Spring 对orm支持</h2>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/docker/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/docker/" itemprop="url">docker 笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:54:09+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><h3 id="CentOS"><a href="#CentOS" class="headerlink" title="CentOS"></a>CentOS</h3><p> 安装：curl -sSL <a href="https://get.daocloud.io/docker" target="_blank" rel="external">https://get.daocloud.io/docker</a> | sh</p>
<p>sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-‘EOF’<br>[dockerrepo]<br>name=Docker Repository<br>baseurl=<a href="https://mirrors.tuna.tsinghua.edu.cn/docker/yum/repo/centos7" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/docker/yum/repo/centos7</a><br>enabled=1<br>gpgcheck=1<br>gpgkey=<a href="https://mirrors.tuna.tsinghua.edu.cn/docker/yum/gpg" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/docker/yum/gpg</a><br>EOF</p>
<h2 id="运行服务"><a href="#运行服务" class="headerlink" title="运行服务"></a>运行服务</h2><h3 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h3><h3 id="运行mysql-instance"><a href="#运行mysql-instance" class="headerlink" title="运行mysql instance"></a>运行mysql instance</h3><ol>
<li>docker pull mysql:latest (或者mariadb) 也可不写，默认最新的tag</li>
<li><p>docker run –name master -p 3306:3306  -e MYSQL_ROOT_PASSWORD=123456  -e REPLICATION_MASTER=true -d mysql:latest</p>
<blockquote>
<p>mysql:latest 一定要在最后，不然 -e 之类的参数会作为启动mysql的参数传入，而不是启动镜像的参数，导致错误ba</p>
</blockquote>
</li>
<li><p>mysql -h127.0.0.1 -P3306 -uroot -p123456  连接master</p>
<blockquote>
<p> 或者通过 docker exec -it containerId /bin/bash  进入容器命令行<br> 在通过 mysql -uroot -pgroup-replication 使用刚才设置的root密码进入mysql控制台,exit退出控制台，再次exit退出docker      </p>
</blockquote>
</li>
</ol>
<h4 id="mysql-group-replication-docker"><a href="#mysql-group-replication-docker" class="headerlink" title="mysql group replication docker"></a>mysql group replication docker</h4><p>以为mysql group replication 要求集群在一个子网中。所以首先使用docker 创建子网。</p>
<ol>
<li><p>docker network create 网络名</p>
</li>
<li><p>docker run -d –net=网络名 -p 3306:3306 –name=master perconalab/mysql-group-replication –loose_replication_boostrap_group=ON</p>
<blockquote>
<p>这里起了主节点，叫master</p>
</blockquote>
</li>
<li><p>docker run -d –net=网络名 –name=slave-1 perconalab/mysql-group-replication –loose_replication_group_seeds=’master:6606’</p>
<blockquote>
<p>这里起了从节点，叫slave-1</p>
</blockquote>
</li>
<li><p>允许从本地访问mysql集群的用户为 rpl_user 密码：rpl_pass</p>
</li>
</ol>
<p><code>从本地无法连接起的mysql集群</code></p>
<ol>
<li>docker exec -it containerId bin/bash</li>
<li>mysql -uroot</li>
<li>select host,user from mysql.user;</li>
<li>host行值为%对应的用户，是允许从外网了连接进来的。localhost 是只允许本地连接</li>
</ol>
<p>mysqld -verbose –help | grep bind-address 查看mysql连接</p>
<p><code>基于mysql8，命令行创建</code><br>主：<br>      docker run –net=meifans -d -p3333:3306 -e MYSQL_ROOT_PASSWORD=123456  –name=node1 mysql:8 –server-id=1</p>
<h4 id="在本地直接配置msyql-group-replication实例"><a href="#在本地直接配置msyql-group-replication实例" class="headerlink" title="在本地直接配置msyql_group_replication实例"></a>在本地直接配置msyql_group_replication实例</h4><p>在当前目录初始化mysql：</p>
<pre><code>1. mkdir data
2. /usr/local/Cellar/mysql/5.7.18/bin/mysqld --initialize-insecure --basedir=/usr/local/Cellar/mysql/5.7.18 --datadir=$PWD/data/s1

3. cd data/s1   touch s1.cnf
4. atom s1.cnf                 添加配置

5. /usr/local/Cellar/mysql/5.7.18/bin/mysqld --defaults-file=/Users/pengfei.zhao/Project/mysql-group-replication/data/s1/s1.cnf

6. mysql -uroot -p -S /usr/local/Cellar/mysql/5.7.18/s1.sock       连接这个mysql instance
</code></pre><p>创建用于组复制的用户：<br>      SET SQL_LOG_BIN=0;<br>      CREATE USER rpl_user@’%’;<br>      GRANT REPLICATION SLAVE ON <em>.</em> TO rpl_user@’%’ IDENTIFIED BY ‘rpl_pass’;<br>      FLUSH PRIVILEGES;<br>      SET SQL_LOG_BIN=1;<br>      CHANGE MASTER TO MASTER_USER=’rpl_user’, MASTER_PASSWORD=’rpl_pass’ FOR   CHANNEL’group_replication_recovery’;</p>
<p>启动组复制：<br>      INSTALL PLUGIN group_replication SONAME ‘group_replication.so’;<br>      SET GLOBAL group_replication_bootstrap_group=ON;                      <strong>只在第一个server时使用，其后server不适用</strong><br>      START GROUP_REPLICATION;<br>      SET GLOBAL group_replication_bootstrap_group=OFF;                      <strong>只在第一个server时使用，其后server不适用</strong></p>
<pre><code>&gt;要启动组，请指示 server s1 引导组，然后启动组复制程序。 此引导应仅由单个 sever 独立完 成，该 server 启动组并且只启动一次。 这就是为什么引导配置选项的值不保存在配置文件中的 原因。 如果将其保存在配置文件中，则在重新启动时，server 会自动引导具有相同名称的第二 个组。 这将导致两个不同的组具有相同的名称。 同样的道理适用于停止和重新启动插件，并且 此选项设置为 ON。
</code></pre><p>添加数据：<br>      CREATE DATABASE test;<br>      use test<br>      CREATE TABLE t1 (c1 INT PRIMARY KEY, c2 TEXT NOT NULL);<br>      INSERT INTO t1 VALUES (1, ‘meifans’);<br>      SELECT * FROM t1;<br>      show binlog events;</p>
<p>查看用户<br>      select host,user from mysql.user;<br>验证binlog<br>      show binlog events;<br>验证组成员加入<br>      select * from performance_schema.replication_group_members;<br>验证server2已同步<br>      show databases like ‘test’;</p>
<p>创建命令</p>
<p>docker run –net=meifans -d -p3333:3306 -e MYSQL_ROOT_PASSWORD=123456 -v my.cnf:/etc/my.cnf –name=node1 mysql:8 –server-id=1</p>
<h2 id="日常命令"><a href="#日常命令" class="headerlink" title="日常命令"></a>日常命令</h2><ul>
<li><p>docker ps 列出运行的服务</p>
<ul>
<li>-a 列出所有容器，包括未运行的。</li>
</ul>
</li>
<li><p>docker images 列出所有</p>
</li>
</ul>
<h2 id="随笔"><a href="#随笔" class="headerlink" title="随笔"></a>随笔</h2><ul>
<li>docker exec -it container-id 或者 image bash  进入运行中服务的环境里，可以env查看环境设置等。<blockquote>
<p>也可用 docker inspect container-id 来查看env<br>+</p>
</blockquote>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/git/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/git/" itemprop="url">git 命令笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:54:09+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="git-工作命令"><a href="#git-工作命令" class="headerlink" title="git 工作命令"></a>git 工作命令</h2><h3 id="add"><a href="#add" class="headerlink" title="add"></a>add</h3><ul>
<li>git add <pathspec>          增加，修改路径下已经track的file，但是忽略删除。</pathspec></li>
<li>git add -u <pathspec>        修改，删除路径下file，但是忽略增加。</pathspec></li>
<li>git add –all <pathspec>     对路径下文件有 增加，修改，删除操作。</pathspec></li>
</ul>
<h3 id="commit"><a href="#commit" class="headerlink" title="commit"></a>commit</h3><ul>
<li><p>git commit -amend  重命名</p>
<h3 id="diff"><a href="#diff" class="headerlink" title="diff"></a>diff</h3></li>
<li><p>git diff 显示 目前文件 与上次提交的区别 (git add 之前的文件与已提交文件的差别)</p>
<blockquote>
<p>merge 之后 git diff 即显示存在冲突的地方</p>
</blockquote>
</li>
<li><p>git diff –staged 显示 暂存区与上次提交的区别 （git add 之后）</p>
</li>
<li>git diff HEAD 显示 当前工作树与上次提交的区别 （add 之前之后文件的和，HEAD是最近一次提交的别名）</li>
<li>git diff –color-words 或者 –word-diff  把一行内的改动显示出来</li>
<li>git diff –stat 简要显示区别 （只显示被改动的文件名）</li>
<li>git diff 分支名 分支名 显示2个分支之间的区别</li>
<li>git diff –shortstat “@{0 day ago}” 显示今天写了多少代码</li>
<li>git diff origin/master 文件名  和远端master比较指定文件的区别<blockquote>
<p>提示</p>
<ul>
<li>各个参数可以组合使用 比如 git diff 分支名 分支名  –stat ，快速判断两个分支之间的不同的文件。</li>
<li>分清楚暂存区和commit的区别</li>
</ul>
</blockquote>
</li>
</ul>
<h3 id="log"><a href="#log" class="headerlink" title="log"></a>log</h3><ul>
<li>git log 显示提交历史</li>
<li>git log –oneline 把每次提交压缩成一行显示</li>
<li>git log –stat   显示每次提交的改动了那些文件 （用于快速查看提交改动了那些文件，而不关心具体如何改动）</li>
<li>git log –patch  显示每次提交之间的改动（也就是每次提交和上次提交相比的改动）</li>
<li>git log graph –all –decorate –oneline  表示提交结构的样子</li>
</ul>
<h3 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h3><ul>
<li><p>git reset –soft或者–hard 摘要（git log 查看每次commit 后面的hash码，不必全复制，代表区别即可）</p>
<blockquote>
<p>把当前分支重置为摘要所代表的commit的状态<br>自动merge失败后，可以add ,commit ,git log 查到想回到哪个分支 ，重置。<br>soft会留下目标commit之后的所有commit，hard会把目标之后的commit删除。</p>
</blockquote>
</li>
<li><p>git reset –hard HEAD       回到合并前的状态，HEAD是当前分支的头的简写。</p>
</li>
<li><p>git reset –hard ORIG_HEAD       撤销已经提交的合并后的代码。(merge 之后解决冲突又add，commit 了)</p>
<blockquote>
<p>但是命令比较危险，如果把已经被别的分支合并的分支删掉，以后和它合并时会出错。</p>
</blockquote>
</li>
<li><p>git reset –hard origin/master 把当前分支放弃，强行和远程master同步</p>
</li>
</ul>
<h3 id="checkout"><a href="#checkout" class="headerlink" title="checkout"></a>checkout</h3><ul>
<li>git checkout 分支名|commit摘要    跳转到某个分支或某次commit</li>
<li>git checkout -b 分支名         基于当前分支创建一个新的分支（分支名），并跳转过去</li>
</ul>
<h3 id="reflog"><a href="#reflog" class="headerlink" title="reflog"></a>reflog</h3><ul>
<li>git reflog  列出head曾经指向过的所有commit，reset –hard 覆盖的commit也可以找到</li>
</ul>
<h3 id="branch"><a href="#branch" class="headerlink" title="branch"></a>branch</h3><ul>
<li>git branch -d 分支名        删除某个分支</li>
<li>git branch -a 显示远端和本地分支</li>
</ul>
<h3 id="merge"><a href="#merge" class="headerlink" title="merge"></a>merge</h3><ul>
<li>git  merge 分支A           把分支A合并到当前分支</li>
</ul>
<h3 id="push"><a href="#push" class="headerlink" title="push"></a>push</h3><ul>
<li>git push origin 分支名     把当前分支推到origin远端的分支</li>
<li>git push -u origin 分支名  若分支不存在，在远端创建一个</li>
<li>git push -f origin 分支名   强行把当前分支推到远端，若不存在创建一个，若存在，覆盖掉。</li>
</ul>
<h3 id="remote"><a href="#remote" class="headerlink" title="remote"></a>remote</h3><ul>
<li>git remote add origin git@github.com:meifans/meifans-patterns.git（例子） 添加一个远端到本地，用origin表示</li>
</ul>
<h3 id="rm"><a href="#rm" class="headerlink" title="rm"></a>rm</h3><ul>
<li><p>git rm -r -n –cached  <em>/Runtime/\</em>      -n：加上这个参数，执行命令时，是不会删除任何文件，而是展示此命令要删除的文件列表预览。</p>
</li>
<li><p>git rm -r –cached  <em>/Runtime/\</em>      最终执行命令.</p>
<blockquote>
<p>不再追踪runtime目录下的所有东西</p>
</blockquote>
</li>
</ul>
<h2 id="git-身份验证命令"><a href="#git-身份验证命令" class="headerlink" title="git 身份验证命令"></a>git 身份验证命令</h2><ul>
<li>启动agent : eval $(ssh-agent -s)</li>
<li>添加key :   ssh-add 私钥名字（不带.pub）</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/shell/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/shell/" itemprop="url">linux/mac 命令笔记</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:54:09+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h2><ul>
<li><p>lsof 列出占用文件的进程信息</p>
<ul>
<li>-i:&lt;端口号&gt; 列出符合条件的进程，协议，端口号</li>
<li>-p 列出指定进程号所打开的文件</li>
</ul>
</li>
<li><p>netstat -anp | grep “端口号”</p>
</li>
<li><p>cat /etc/redhat-release 查看linux具体版本</p>
</li>
<li><p>cat /proc/version        查看内核版本</p>
</li>
<li><p>systemctl enable/start docker 启动docker服务</p>
</li>
<li><p>zgrep</p>
</li>
<li><p>ll 查看权限</p>
<blockquote>
<p>drwxr-xr-x<br>第一位代表文件类型，d:文件目录，l:链接文件,-:是普通文件，p:是管道<br>2，3，4(rwx)代表文件拥有者的权限，r是读，w是写，x是执行<br>5，6，7(r-x)代表同组的用户权限<br>8，9，10（r-x）代表其他人的权限</p>
</blockquote>
</li>
<li><p>ps aux | grep 服务名    查看服务是否起来，什么时间起来的</p>
</li>
<li><p>压缩</p>
<ul>
<li>tar -xf 文件名   解压缩文件</li>
<li>unzip 文件名  解.zip</li>
</ul>
</li>
<li><p>mv 原文件 新名字    重命名和移动文件</p>
</li>
<li><p>netstat -a 列出所有端口</p>
</li>
<li><p>ip 地址<br>ifconfig | grep inet</p>
</li>
<li><p>追溯DNS解析</p>
<ul>
<li>host hostname（google.com）  显示域名解析后的ip</li>
<li>dig +trace  hostname    dns 解析过程</li>
</ul>
</li>
<li><p>权限</p>
<ul>
<li>chmod 755 目录</li>
</ul>
</li>
<li><p>查看log</p>
<ul>
<li>less 文件名    f 向下，k向上</li>
<li>head -n 1     只显示一条，与grep连用</li>
</ul>
</li>
<li><p>时间戳</p>
<ul>
<li>date -r 1503486171   把时间戳换成时间<h3 id="zsh"><a href="#zsh" class="headerlink" title="zsh"></a>zsh</h3></li>
</ul>
</li>
</ul>
<p><strong>安装</strong></p>
<pre><code>brew install zsh
chsh -s `which zsh`
</code></pre><h4 id="别名"><a href="#别名" class="headerlink" title="别名"></a>别名</h4><p>zsh 不仅支持普通 alias，还支持针对文件类型的 alias。我配置的文件类型 alias 如下：</p>
<pre><code>alias -s gz=&apos;tar -xzvf&apos;
alias -s tgz=&apos;tar -xzvf&apos;
alias -s zip=&apos;unzip&apos;
alias -s bz2=&apos;tar -xjvf&apos;
alias -s php=vi
alias -s py=vi
alias -s rb=vi
alias -s html=vi
alias gcid=&quot;git log | head -1 | awk &apos;{print substr(\$2,1,7)}&apos; | pbcopy&quot;
</code></pre><p>配置完毕之后，在 zsh 下直接输入xxx.rb，将自动用 vi 打开，直接输入xxx.tgz，将直接按照tar -xzvf解压。最后一个gcid将当前 git 项目的第一个 commit 的 id 复制到系统剪切板（pbcopy是 Mac 下的复制到系统剪切板命令，linux 请参考相应的发行版更改），在执行 rebase 的时候特别方便。</p>
<h4 id="自动补全"><a href="#自动补全" class="headerlink" title="自动补全"></a>自动补全</h4><ul>
<li>tar -      按tab自动补全参数，命令，路径</li>
<li>kill java  按tab会出现Java程序的进程号</li>
</ul>
<h4 id="跳转"><a href="#跳转" class="headerlink" title="跳转"></a>跳转</h4><ul>
<li>d        显示当前session访问过的目录</li>
<li>目录      无需cd，直接输入目录。</li>
<li>..       表示后退一级目录，../../后退两级</li>
</ul>
<h4 id="历史记录"><a href="#历史记录" class="headerlink" title="历史记录"></a>历史记录</h4><p><strong>跨session共享</strong></p>
<ul>
<li>git-上   搜索用过的所有git命令</li>
</ul>
<h4 id="通配符搜索"><a href="#通配符搜索" class="headerlink" title="通配符搜索"></a>通配符搜索</h4><ul>
<li>ls *.md   搜索当前目录下的md文件</li>
</ul>
<h4 id="oh-my-zsh"><a href="#oh-my-zsh" class="headerlink" title="oh-my-zsh"></a>oh-my-zsh</h4><p>oh-my-zsh 是最为流行的 zsh 配置文件，提供了大量的主题和插件，极大的拓展了 zsh 的功能，推动了 zsh 的流行，有点类似于 rails 之于 ruby。</p>
<pre><code># install
# via curl
sh -c &quot;$(curl -fsSL https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;
# via wget
sh -c &quot;$(wget https://raw.github.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)&quot;
</code></pre><p>安装之后，source ~/.zshrc使之生效</p>
<p><strong>主题</strong></p>
<p>oh-my-zsh 内置了大量主题，可在~/.oh-my-zsh/themes中查看具体的配置。</p>
<p><strong>插件</strong></p>
<p>oh-my-zsh 提供极为丰富的插件，在~/.oh-my-zsh/plugins目录下查看具体的配置。在.zshrc中写入plugin(git autojump osx)即可使用插件</p>
<ul>
<li><p>git 精简 git 命令，减少输入字符数。参见 <a href="https://github.com/robbyrussell/oh-my-zsh/wiki/Plugin:git" target="_blank" rel="external">Plugin:git</a>。该插件提供的快捷命令比较多，挑几个常用和好记的记忆即可，不必全记。</p>
</li>
<li><p><a href="https://github.com/wting/autojump" target="_blank" rel="external">autojump</a>  按照你的使用频率记录路径，使得目录的跳转更为方便。安装brew install autojump。如需跳转到包含 ‘foo’ 的目录，执行j foo，这是最基础，也是最常用的命令。除此之外，还有jc, jo, jco命令，查看官网文档获取更多的使用方法。</p>
</li>
<li><p>OSX 该插件增强 Mac 下的使用体验，提供了如下命令：</p>
<ul>
<li>cdf: 在 Finder 中打开要 cd 的目录；</li>
<li>quick-look: 快速预览该文件，类似于在 Finder 中按下空格键；<br>man preview: 在 preview 中打开 man page；<br>itunes: 命令行操作 iTunes。</li>
</ul>
</li>
</ul>
<h2 id="mac-环境"><a href="#mac-环境" class="headerlink" title="mac 环境"></a>mac 环境</h2><h3 id="压缩-amp-解压缩"><a href="#压缩-amp-解压缩" class="headerlink" title="压缩 &amp; 解压缩"></a>压缩 &amp; 解压缩</h3><ul>
<li><p>安装zsh extract 插件 ：提供各种压缩形式的解压缩（实际还是需要各种解压缩的命令支持）</p>
<ul>
<li>zsh 中 ~/.zshrc 中 plugins=(… extract)</li>
<li>source ~/.zshrc</li>
</ul>
</li>
<li><p>mac下没有unrar,使用 brew install unrar (解压rar文件)</p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/15/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="赵鹏飞">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Meifans">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/09/15/hello-world/" itemprop="url">Hello World</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Veröffentlicht am</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-09-15T11:11:30+08:00">
                2017-09-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure>
<p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          
            <p class="site-author-name" itemprop="name">赵鹏飞</p>
            <p class="site-description motion-element" itemprop="description">技术 博客</p>
        </div>

        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
            
              <a href="/archives/">
            
                <span class="site-state-item-count">8</span>
                <span class="site-state-item-name">Artikel</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">赵鹏飞</span>

  
</div>


  <div class="powered-by">Erstellt mit  <a class="theme-link" href="https://hexo.io">Hexo</a></div>

  <span class="post-meta-divider">|</span>

  <div class="theme-info">Theme &mdash; <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.2</div>


        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>


  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  








  





  

  

  

  

  

  

</body>
</html>
